---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by shoufeng.zhang.
--- DateTime: 2022/6/15 20:29
---
local ModuleRefer = require('ModuleRefer')
local CommonItemDetailsDefine = require('CommonItemDetailsDefine')
local BaseTableViewProCell = require ('BaseTableViewProCell')
local Delegate = require('Delegate')

---@class HeroInfoTableViewCell : BaseTableViewProCell
local HeroInfoTableViewCell = class('HeroInfoTableViewCell', BaseTableViewProCell)

function HeroInfoTableViewCell:ctor()

end

function HeroInfoTableViewCell:OnCreate()
    self.heroSlot = self:LuaBaseComponent('child_card_hero_m')
    self.goGroupToken = self:GameObject('p_group_token')
    self.compGroupToken = self:LuaObject('p_group_token')
end


function HeroInfoTableViewCell:OnShow(param)

end

function HeroInfoTableViewCell:OnOpened(param)
end

function HeroInfoTableViewCell:OnClose(param)
end

---OnFeedData
---@param param HeroConfigCache
function HeroInfoTableViewCell:OnFeedData(param)
    self.heroData = param
    ---@type HeroInfoData
    local itemData = {
        heroData = self.heroData,
        onClick = Delegate.GetOrCreate(self,self.OnItemCellClick)
    }
    self.heroSlot:FeedData(itemData)
    local hasHero = itemData.heroData:HasHero()
    self.heroSlot.Lua:SetGray(not hasHero)
    self.goGroupToken:SetActive(not hasHero)
    if not hasHero then
        local pieceData = {}
        pieceData.compareType = CommonItemDetailsDefine.COMPARE_TYPE.LEFT_OWN_RIGHT_COST
        pieceData.itemId = itemData.heroData.configCell:PieceId()
        pieceData.num1 = ModuleRefer.InventoryModule:GetAmountByConfigId(itemData.heroData.configCell:PieceId())
        pieceData.num2 = itemData.heroData.configCell:ComposeNeedPiece()
        self.compGroupToken:FeedData(pieceData)
    end
end

function HeroInfoTableViewCell:Select(param)
    self.heroSlot.Lua:ChangeStateSelect(true)
end

function HeroInfoTableViewCell:UnSelect(param)
    self.heroSlot.Lua:ChangeStateSelect(false)
end

function HeroInfoTableViewCell:OnItemCellClick()
    self:SelectSelf()
end

return HeroInfoTableViewCell;

