---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xh.
--- DateTime: 2022/7/21 15:57
---

local BaseUIComponent = require('BaseUIComponent')
local Delegate = require("Delegate")

---@class TouchInfoTextCompData
---@field content string|fun():string
---@field needTick boolean

---@class TouchInfoTextComponent : BaseUIComponent
local TouchInfoTextComponent = class("TouchInfoTextComponent", BaseUIComponent)

function TouchInfoTextComponent:OnCreate()
    self._p_text_description = self:Text("p_text_description")
end

---@param datum TouchInfoTextCompData
function TouchInfoTextComponent:OnFeedData(datum)
    if type(datum.content) == "function" then
        self._p_text_description.text = datum.content()
    elseif type(datum.content) == "string" then
        self._p_text_description.text = datum.content
    end
    if datum.needTick then
        self.contentFunc = datum.content
        g_Game:AddSecondTicker(Delegate.GetOrCreate(self, self.OnTick))
    end
end

function TouchInfoTextComponent:OnTick()
    if type(self.contentFunc) == "function" then
        self._p_text_description.text = self.contentFunc()
    end
end

function TouchInfoTextComponent:OnClose()
    if self.contentFunc then
        g_Game:RemoveSecondTicker(Delegate.GetOrCreate(self, self.OnTick))
        self.contentFunc = nil
    end
end

return TouchInfoTextComponent